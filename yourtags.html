<!DOCTYPE html>
<html lang="en">
<head>
	<link href="bootstrap/css/bootstrap.css" rel="stylesheet" />
	<link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet" />
	<link href="styles.css" rel="stylesheet" />
	<link href="bootstrap/css/style.css?a1" rel="stylesheet" />
	
	
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="scripts/jquery.placeholder.min.js" type="text/javascript"></script>
	<script src="scripts/bootstrap.min.js" type="text/javascript"></script>
	<script src="js/tag-filter.js"></script>
		<script src="js/fs-wrapper.js"></script>
		<script src="js/yelp-wrapper.js"></script>
		<script src="js/mustache.js"></script>
		<script src="js/jquery_1.8.2.min.js"></script>
		<script type="text/javascript">

			function addTag(e) {
				var $e = $(e);

				$e.attr('onclick', 'removeTag(this)');

				$e.remove();
				$e.appendTo($('#chosen-tags'));
				$remove = $e.find($('.tag-remove'));
				$remove.css('display', 'inline');

				$e.removeClass('clear-both');
			}

			function removeTag(e) {
				var $e = $(e);

				$e.attr('onclick', 'addTag(this)');
				$e.addClass('tag-clickable clear-both');

				$e.appendTo($('#existing-tags'));
				$remove = $e.find($('.tag-remove'));
				$remove.css('display', 'none');
			}

			function loadTags() {
				$('<span id ="japanese" class="tag tag-clickable clear-both pull-left" onclick="addTag(this);"> Japanese  <button class="close tag-remove" style="display:none; margin-left: 5px; color: white;">&times;</button></span>').appendTo('#existing-tags');
				}

			function displayResults() {
				$.get("data.txt",
				   function(data){
				   	var i = 0;
				   	var $id = data.businesses[i].id;
				   	var $name = data.businesses[i].name;
				   	var $categories = data.businesses[i].categories;
				   	var $display_phone = data.businesses[i].display_phone;
				   	var $image_url = data.businesses[i].image_url;
				   	var $address = data.businesses[i].location.address;
				   	var $city = data.businesses[i].location.city;
				   	var $neighborhoods = data.businesses[i].location.neighborhoods;
				   	var $rating_img_url = data.businesses[i].rating_img_url;
				   	var $review_count = data.businesses[i].review_count;
				   	var $url = data.businesses[i].url;
				   	var $tags = data.businesses[i].tags;
				   	$("#results").empty();
				    $('#results').append('<a href="' + $url + '"> <div id ="' + $id + '"class="well well-small clearfix result"> <div class="span3 pull-left"><h3>' + $name + '</h3> <p><b> Neighborhoods: </b>' + $neighborhoods + '</p><p class="categories"><b> Categories: </b></div><div class="middle span3 pull-left"> <img src="' + $rating_img_url + '"> ' + $review_count + ' reviews <address>' + $display_phone + '<br>' + $address + '<br>' + $city + '</address></div><div class="span4 pull-left biz-tags"><h4> Your Tags </h4></div></div></a>');

				     processTags($tags, $id);
				     processCategories($categories, $id);
				   }, "json");
					
				function processTags(e, id) {
				var $e = $(e);
				jQuery.each($e, function(i, val){
						$("#" + id + " div.biz-tags").append('<span id="' + val + '" class="tag pull-left">' + val + ' </span>');
				});
				}

				function processCategories(e, id) {
				var $e = $(e);
				jQuery.each($e, function(i, val){
						$("#" + id + " p.categories").append(val[0] + ", ");
				});
				}
			}

			
		</script>
</head>
<body onload="loadTags()">
	<div class="container">
		<div>
		    <ul class="nav nav-tabs">
				<li class="active">
			    	<a href="search-results.html">Home</a>
			  	</li>
			 	<li>
		      		<a href="tag-assignment-wrapper.html">Your Tags</a>
		    	</li>
			  	<li>
			  		<a href="#">...</a>
			  	</li>
		  	</ul>
		</div>
		<div class="span11" style="text-align: center;"> 
			<h1 class="yelp-red"> Your Tags </h1>
		</div>
		<div class="row-fluid">
			<div id ="existing-tags-container" class="span2 well well-small">
				<!-- Sidebar for tags -->
				<h2> Tag List </h2>
				<p> Click on tag to filter by that tag </p>
					<div id ="existing-tags" >
					</div>
			</div>
			<div class="span10">
				<!-- Main content for filtered businesses go here -->
				<button type="submit" class="btn btn-info pull-left" onclick="displayResults()">Display Results</button>
	  			<div id="chosen-tags" class="span10 well well-small">
				</div>
	  			<!-- <form class="form-search">
	  				<input type="text" class="input-large search-query span9">
				</form> -->
						<div>
							<h3> Filtered Results </h3>
							<hr style="margin-top: 5px;">
							<div id="results">
									<!-- Filtered Results Start Here -->
							</div>
						</div>
				</div>
			</div>
		</div>
	</div>
<body>
</html>